---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { slugify } from '../../utils/slugify';

const parts = (await getCollection('parts')).sort(
    (a, b) => a.data.title.localeCompare(b.data.title)
);
---

<!doctype html>
<html lang="en">
<head>
  <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  <style>
    main {
      width: 960px;
    }
    ul {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      list-style-type: none;
      margin: 0;
      padding: 0;
    }
    ul li {
      width: calc(50% - 1rem);
    }
    ul li * {
      text-decoration: none;
      transition: 0.2s ease;
    }
    ul li:first-child {
      width: 100%;
      margin-bottom: 1rem;
      text-align: center;
    }
    ul li:first-child img {
      width: 100%;
    }
    ul li:first-child .title {
      font-size: 2.369rem;
    }
    ul li a {
      display: block;
    }
    .title {
      margin: 0;
      color: #f1f1f1;
      line-height: 1;
      font-size: 1.5em;
    }
    .part-number {
      font-style: italic;
      color: #a0a0a0;
    }
    ul li a:hover h4,
    ul li a:hover .date {
      color: var(--accent);
    }
    ul li a:hover img {
      box-shadow: var(--box-shadow);
    }
    @media (max-width: 720px) {
      ul li {
        width: 100%;
      }
    }
  </style>
</head>
<body>
<Header />
<main class="text-white max-w-3xl mx-auto px-4">
  <section>
    <h1 class="text-4xl font-bold mb-8 text-center">Compatible Parts</h1>
    <ul>
      {
        parts.map((part) => {
          const slug = `${slugify(part.data.title)}-${part.data.partNumber}`;
          return (
              <li>
                <a href={`/parts/${slug}/`}>
                  {part.data.heroImage && (
                      <Image
                          width={720}
                          height={360}
                          src={part.data.heroImage}
                          alt={`Image for ${part.data.title}`}
                          class="w-full h-auto mb-4"
                      />
                  )}
                  <h4 class="title">{part.data.title}</h4>
                  <p class="part-number">Part #: {part.data.partNumber}</p>
                </a>
              </li>
          )
        })
      }
    </ul>
  </section>
</main>
<Footer />
</body>
</html>